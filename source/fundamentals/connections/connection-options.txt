.. _rust-connection-options:

=====================
Connection Options
=====================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

In this guide, you can learn about MongoDB connection and authentication
options. You can pass connection options as parameters of the connection
string URI to specify the behavior of the client. To learn more about connection strings, see
:manual:`Connection String URI Format </reference/connection-string>`.

.. list-table::
   :header-rows: 1
   :widths: 30 12 12 46

   * - Option Name
     - Accepted Values
     - Default Value
     - Description

   * - **appName**
     - Any string
     - None
     - Specifies the application name that the ``Client`` instance sends to the server as part of the handshake.
       Specifying an ``appName`` can help you use the server logs to determine which ``Client`` is connected
       to the server.

   * - **authMechanism**
     - string
     - None
     - Specifies which authentication mechanism to use.
       If empty, one will be negotiated with the server.

   * - **authMechanismProperties**
     - string
     - None
     - Specifies additional properties for the authentication mechanism
       specified in the ``authMechanism`` option.

   * - **authSource**
     - string
     - See description
     - Specifies the database used to authenticate.
       This option defaults to ``admin`` for SCRAM-based authentication mechanisms,
       ``$external`` for the ``MONGODB-X509`` mechanism, and the database name or
       ``$external`` for the ``PLAIN`` mechanism.

   * - **compressors**
     - A comma-separated list of strings
     - None
     - Specifies compressors that the ``Client`` is willing to use in the order they are specified in the configuration.
       The ``Client`` sends this list of compressors to the server.
       The server responds with the intersection of its supported list of compressors.
       The order of compressors indicates preference of compressors.

   * - ***connectTimeoutMS***
     - non-negative integer
     - 10 seconds
     - Specifies the connection timeout, in milliseconds, passed to each underlying TCP stream when attempting to connect to the server.

   * - **direct**
     - boolean
     - ``false``
     - Specifies whether the ``Client`` will directly connect to a single host rather than automatically discovering all servers in the cluster.

   * - **heartbeatFrequencyMS**
     - integer greater than or equal to 500
     - 10 seconds
     - Specifies the each monitoring thread waits between performing server checks.

   * - **journal**
     - boolean
     - ``false``
     - Requests acknowledgment that the operation propagated to the on-disk journal.

   * - **localThresholdMS**
     - non-negative integer
     - 15 milliseconds
     - Specifies how much longer, in milliseconds, that the average round trip time between the driver and server can be
       compared to the least round trip time of all the suitable servers.
       A value of ``0`` indicates that there is no latency window, so only the server with the lowest average round trip time is eligible.

   * - **maxIdleTimeMS**
     - non-negative integer
     - 0
     - Specifies the amount of time, in milliseconds, that a connection can remain idle in a connection pool before being closed.
       A value of ``0`` indicates that connections are not closed due to being idle.

   * - **maxStalenessSeconds**
     - -1, or any integer greater than or equal to ``90``
     - ``-1``
     - Specifies the maximum lag, in seconds, behind the primary node that a secondary node can be to be 
       considered for the given operation.

       The value of this option must be at least ``90``, or the operation raises an error.
       A value of ``-1`` means there is no maximum lag.

   * - **maxPoolSize**
     - non-negative integer
     - 10
     - Specifies the maximum number of connections that the ``Client`` can create in a connection pool for a given server.
       If you attempt an operation while the value of ``maxPoolSize`` connections are checked out,
       the operation waits until an in-progress operation finishes and the connection returns to the pool.

   * - **minPoolSize**
     - non-negative integer
     - 0
     - Specifies the minimum number of connections that will be available in a server's connection pool at a given time.
       If fewer than **minPoolSize** connections are in the pool, connections will be added to the pool in the background
       until **minPoolSize** is reached.

   * - **readConcernLevel**
     - string
     - None
     - Specifies the default read concern for operations performed on the ``Client``.
       See the `ReadConcern <https://docs.rs/mongodb/latest/mongodb/options/struct.ReadConcern.html>`__
       type documentation for more details.

   * - **readPreferenceField**
     - string
     - ``primary``
     - Specifies how the driver routes a read operation to members of a replica set.
       For more information see the :manual:`Read Preference documention </core/read-preference>`.

   * - **readPreferenceTags**
     - comma-separated key:value pairs, for example, "dc:ny,rack:1"
     - None
     - Specifies which replica set members are considered for operations.
       Each instance of this key is a separate tag set.
       Each tag set will be checked in order until one or more servers is found with each tag in the set.

   * - **replicaSet**
     - string
     - None
     - Specifies the name of the replica set that the ``Client`` connects to.

   * - **retryReads**
     - boolean
     - ``true``
     - Specifies whether the client retries a read operation if the operation fails.

   * - **serverSelectionTimeoutMS**
     - non-negative integer
     - 30 seconds
     - Specifies the amount of time, in milliseconds, that the ``Client`` instance waits when attempting to select a server for an operation before timing out.

   * - **tls**
     - boolean
     - ``false``
     - Specifies the TLS configuration for the ``Client`` to use in its connections with the server.
       By default, TLS is off.

   * - **tlsAllowInvalidCertificates** (or **tlsInsecure**)
     - boolean
     - ``true``
     - Specifies whether the ``Client`` returns an error if the server presents an invalid certificate.
       (Do not set to ``true`` in production.
       This is only for testing.)

   * - **tlsCAFile**
     - string
     - See description.
     - Specifies the path to the CA file that the ``Client`` uses for TLS.
       If you do not specify this option, the driver uses the Mozilla root certificates from the ``webpki-roots`` crate.

   * - **tlsCertificateKeyFile**
     - string
     - None
     - Specifies the path to the certificate file that the ``Client`` presents to the server to verify its identify.
       If you do not set this option, the ``Client`` instance does not attempt to verify its identity to the server.

   * - **w**
     - non-negative integer or string
     - None
     - Requests acknowledgment that the operation has propagated to a specific number or variety of servers.

   * - **wTimeoutMS**
     - non-negative integer
     - No timeout
     - Specifies a time limit for the write concern.
       If an operation has not propagated to the requested level within the time limit, an error will return.

   * - **zlibCompressionLevel**
     - integer between -1 and 9 (inclusive)
     - ``-1``
     - Specifies the level field of the ``zlib`` compression when in use.
       See the `compressor API documentation <{+api+}/options/enum.Compressor.html#variant.Zlib>`__ for more information.
       (Requires enabling the ``zlib-compression`` feature.)
       ``-1`` means no timeout.

For a full list of options, see the `ClientOptions API documentation <{+api+}/options/struct.ClientOptions.html>`__.
